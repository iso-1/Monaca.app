<!DOCTYPE HTML>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <meta http-equiv="Content-Security-Policy" content="default-src * data: gap: https://ssl.gstatic.com; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'">
    <script src="components/loader.js"></script>
    <link rel="stylesheet" href="components/loader.css">
    <link rel="stylesheet" href="css/styles.css">
    <script src="js/cssua.min.js"></script>
    <script src="js/app.js"></script>
    <script>
    var KEY = "key1";
    // ローカルストレージをセットします。
    function localStorageSetItem() {
        var obj = $("date-deadline").text();
        localStorage.setItem(KEY, JSON.stringify(obj));
        alert("Local Storage: データーをセットしました。")
    }
    // ローカルストレージの値を取得します。。document文書
    function localStorageGetItem() {
        var item = localStorage.getItem(KEY);
        var obj = JSON.parse(item);
        document.getElementById("content").innerHTML = obj;
    }
    
    // ローカルストレージの全データを消去します。ここまで
    function localStorageClear() {
        localStorage.clear();
        document.getElementById("content").innerHTML = "";
    }
</script>
    
</head>
<body>
    <div data-role="page" id="list-page"> <!--  data-role page JQmobileのページ作成 -->
        <div data-role="header" data-position="fixed" data-theme="c">
            <h1>TODO App</h1>
            <a href="#add-page" data-icon="add" class="ui-btn-left">追加</a>
            <a href="f.html" data-icon="add" class="ui-btn-right">通知</a>
        </div>
        <div data-role="content">
            <ul data-role="listview" data-inset="true" id="todo-list"></ul>
            <div> id="timer">00:00.000</div>
            <div> class="controls"
                <input type="button" value="min" id="min">Min</button>
                <> id="sec">Sec</button>
                <button> id="reset">Reset</button>
                <button> id="start">Start</button>
            </div>
            <div>
                <input type="button" value="日にち" onclick="localStorageSetItem();" />
                <input type="button" value="残り日数" onclick="localStorageGetItem();" />
                <input type="button" value="削除" onclick="localStorageClear();" />
                
                <div id="content"></div>


            </div>
        </div>
    </div>

    <div data-role="page" id="add-page">
        <div data-role="header" data-position="fixed" data-theme="c"> 
            <h1>TODOの追加</h1>
            <a href="#list-page" data-icon="back" class="ui-btn-left">戻る</a>
        </div>
        <div data-role="content">
            <input id="todo-title" type="text" placeholder="TODOタイトル">
            <textarea id="todo-body" style="height: 8em" placeholder="説明文"></textarea>
            <!-- タイマーここから -->
            <div id="CDT"></div>

<script language="JavaScript" type="text/javascript">
function CountdownTimer(elm,tl,mes){
 this.initialize.apply(this,arguments);
}
CountdownTimer.prototype={
 initialize:function(elm,tl,mes) {
  this.elem = document.getElementById(elm);
  this.tl = tl;
  this.mes = mes;
 },countDown:function(){
  var timer='';
  var today=new Date();
  var day=Math.floor((this.tl-today)/(24*60*60*1000));
  var hour=Math.floor(((this.tl-today)%(24*60*60*1000))/(60*60*1000));
  var min=Math.floor(((this.tl-today)%(24*60*60*1000))/(60*1000))%60;
  var sec=Math.floor(((this.tl-today)%(24*60*60*1000))/1000)%60%60;
  var milli=Math.floor(((this.tl-today)%(24*60*60*1000))/10)%100;
  var me=this;
  if( ( this.tl - today ) > 0 ){
   if (day) timer += '<span class="day">'+day+'日</span>';
   if (hour) timer += '<span class="hour">'+hour+'時間</span>';
   timer += '<span class="min">'+this.addZero(min)+'分</span><span class="sec">'+this.addZero(sec)+'秒</span><span class="milli">'+this.addZero(milli)+'</span>';
   this.elem.innerHTML = timer;
   tid = setTimeout( function(){me.countDown();},10 );
  }else{
   this.elem.innerHTML = this.mes;
   return;
  }
 },addZero:function(num){ return ('0'+num).slice(-2); }
}
function CDT(){
 var tl = new Date('2017/10/1 00:00:00');
 var timer = new CountdownTimer('CDT',tl,'終了しました');
 timer.countDown();
}
window.onload=function(){
 CDT();
}
</script>
            <!--ここまで-->
            <input type="text" id="date-deadline" class="input-text">
            <input id="add-button" type="button" value="保存" onclick="addTodo(), localStorageSetItem();">
        </div>
    </div>
</body>
</html>